FROM python:3.9

WORKDIR /app

COPY requirements.txt requirements.txt

RUN pip install -r requirements.txt --no-cache-dir

ARG SECRET_KEY
ARG VIRUS_TOTAL_API_KEY
ARG MONGODB_URI
ARG MALWARE_DETECTION_SERVER_API_KEY

ENV SECRET_KEY=${SECRET_KEY}
ENV VIRUS_TOTAL_API_KEY=${VIRUS_TOTAL_API_KEY}
ENV MONGODB_URI=${MONGODB_URI}
ENV MALWARE_DETECTION_SERVER_API_KEY=${MALWARE_DETECTION_SERVER_API_KEY}

EXPOSE 8080

COPY . .

CMD ["uvicorn", "api.main:app", "--host", "0.0.0.0", "--port", "8080"]
